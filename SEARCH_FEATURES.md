# 🔍 高级搜索功能文档

## 功能概述
商品管理系统现已支持强大的多字段搜索功能，用户可以在不同字段中精确搜索，提供更灵活和高效的产品查找体验。

## 🎯 核心特性

### 1. 多字段搜索支持
支持在以下字段中搜索：
- **商品名称** (name) - 产品的完整名称
- **公司名称** (company_name) - 制造商或供应商名称  
- **商品描述** (description) - 产品详细描述
- **商品分类** (category) - 产品分类信息
- **商品编号** (sku) - 产品SKU编码

### 2. 搜索模式
#### 全字段搜索 (默认)
- 在所有支持的字段中同时搜索关键词
- 提供最广泛的搜索结果覆盖

#### 指定字段搜索
- 用户可选择特定字段进行精确搜索
- 支持多个字段组合搜索
- 提高搜索精度，减少无关结果

### 3. 高级筛选
- **公司筛选**: 按公司名称过滤结果
- **分类筛选**: 按产品分类过滤结果  
- **价格区间**: 设置最低/最高价格范围
- **库存筛选**: 按最低库存数量筛选

### 4. 智能搜索建议
- 实时搜索建议（输入2个字符后触发）
- 显示匹配的产品名称、公司和价格
- 点击建议直接应用搜索
- 500毫秒延迟避免过频请求

## 🔧 API接口

### 1. 商品搜索 API
```
GET /api/products?search={keyword}&searchFields={fields}&...
```

**参数说明:**
- `search`: 搜索关键词
- `searchFields`: 搜索字段 (可选)
  - `all` - 搜索所有字段 (默认)
  - `name,company_name` - 指定字段，用逗号分隔
- `company`: 公司名称筛选
- `category`: 分类筛选
- `minPrice`: 最低价格
- `maxPrice`: 最高价格
- `page`: 页码
- `limit`: 每页数量

**示例:**
```bash
# 全字段搜索iPhone
curl "/api/products?search=iPhone"

# 只在商品名称中搜索iPhone  
curl "/api/products?search=iPhone&searchFields=name"

# 在商品名称和描述中搜索手机
curl "/api/products?search=手机&searchFields=name,description"

# 搜索苹果公司的产品
curl "/api/products?search=iPhone&company=苹果"

# 搜索指定价格区间的产品
curl "/api/products?search=手机&minPrice=1000&maxPrice=5000"
```

### 2. FTS5 全文搜索 API
```
GET /api/search?q={keyword}&searchFields={fields}
```

**特性:**
- 使用SQLite FTS5全文搜索引擎
- 支持BM25相关性排序
- 更快的搜索响应速度
- 支持字段特定的FTS查询

**示例:**
```bash
# FTS5全字段搜索
curl "/api/search?q=iPhone"

# FTS5指定字段搜索
curl "/api/search?q=iPhone&searchFields=name,description"
```

### 3. 搜索字段信息 API
```
GET /api/search-fields
```

**返回信息:**
- 可搜索字段列表及描述
- 各字段的统计信息（如公司数量、分类数量）
- 搜索模式说明

## 💡 使用方法

### 前端界面操作

#### 1. 基础搜索
1. 在搜索框输入关键词
2. 点击"搜索"按钮或按Enter键
3. 系统在所有字段中搜索

#### 2. 高级搜索
1. 点击"高级搜索"按钮展开选项
2. 选择要搜索的字段（勾选复选框）
3. 设置额外筛选条件（公司、分类、价格）
4. 点击"搜索"执行精确查询

#### 3. 搜索建议
1. 在搜索框输入2个字符后
2. 系统自动显示相关产品建议
3. 点击建议项直接搜索该产品

#### 4. 清空搜索
1. 点击"清空"按钮
2. 重置所有搜索条件和筛选器
3. 返回完整产品列表

## 🎨 用户体验优化

### 界面设计
- **响应式设计**: 适配桌面和移动设备
- **渐进展开**: 高级选项可折叠，保持界面简洁
- **视觉反馈**: 搜索建议悬停效果和选中状态
- **直观操作**: 清晰的标签和说明文字

### 性能优化
- **延迟执行**: 搜索建议防抖处理，避免频繁请求
- **结果缓存**: 搜索结果在前端缓存，提升响应速度
- **分页加载**: 大量结果分页显示，优化加载速度

## 📊 搜索统计

### 当前数据规模
- **商品总数**: 5,231条
- **公司数量**: 103家
- **分类数量**: 20个
- **搜索索引**: 完整FTS5索引支持

### 性能指标
- **API响应**: < 200ms
- **搜索建议**: < 300ms  
- **全文搜索**: < 150ms (FTS5引擎)
- **复杂筛选**: < 500ms

## 🔧 技术实现

### 后端技术
- **Hono框架**: 轻量级API路由
- **SQLite FTS5**: 全文搜索引擎
- **动态SQL**: 灵活的查询条件构建
- **参数验证**: 搜索字段安全性检查

### 前端技术  
- **原生JavaScript**: 无框架依赖
- **CSS Grid/Flexbox**: 响应式布局
- **事件监听**: 实时输入处理
- **DOM操作**: 动态内容渲染

## 🚀 未来扩展

### 计划功能
1. **保存搜索**: 用户可保存常用搜索条件
2. **搜索历史**: 记录最近搜索关键词
3. **自动完成**: 基于历史数据的智能提示
4. **搜索分析**: 搜索热词和趋势统计
5. **高级语法**: 支持AND/OR/NOT等搜索操作符

### 优化方向
1. **搜索结果排序**: 多维度相关性排序
2. **拼写纠错**: 自动纠正搜索关键词
3. **同义词支持**: 扩展相关词搜索
4. **搜索导出**: 搜索结果批量导出
5. **API限流**: 防止搜索API滥用

## 📝 更新日志

### v1.1.0 (2025-08-31)
- ✅ 新增多字段搜索支持
- ✅ 实现高级搜索界面
- ✅ 添加搜索建议功能
- ✅ 增强API参数支持
- ✅ 优化搜索性能和用户体验